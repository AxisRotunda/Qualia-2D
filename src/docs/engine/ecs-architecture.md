# [T1] ECS Architecture: Single Source of Truth
ID: ENGINE_ECS_V1.0 | Role: Data Governance.

## 1. THE ARCHITECTURE
Qualia2D utilizes a high-performance Registry-backed ECS. Unlike traditional object-oriented game loops, data is stored in flat Maps keyed by `EntityId`, ensuring cache-friendly access and clear separation of state from logic.

## 2. DATA STRUCTURES

### [D0] THE ENTITY
Entities are irreducible integers generated by the `EntityGenerator`.
- **Invariants**: Once deleted, an ID is never reused within the same session.
- **Reset**: Scene transitions trigger `EntityGenerator.reset()`.

### [D1] THE COMPONENTS
| Component | Store | Responsibility |
| :--- | :--- | :--- |
| `Transform2D` | `transforms` | Spatial state (X, Y, Rotation). |
| `Sprite2D` | `sprites` | Visual projection (Color, Size, Layer). |
| `RigidBody2D` | `rigidBodies` | Physics state (WASM Handle). |
| `Collider2D` | `colliders` | Collision hull (WASM Handle). |
| `PlayerController`| `players` | Input mapping config. |
| `ForceField2D` | `forceFields` | Non-collision dynamics. |

## 3. LIFECYCLE MANAGEMENT
Governed by `ComponentStoreService`:
1. **ADD**: `addEntity(id)` registers the ID in the master list.
2. **QUERY**: Systems filter entities by presence in specific Maps (e.g., "All entities with Transform AND Sprite").
3. **CLEANUP**: `removeEntity(id)` iterates all registries to purge components, preventing memory leaks and orphaned WASM handles.

## 4. SIGNAL INTEGRATION
- `entitiesList`: A read-only signal for UI hierarchy reactivity.
- `entityCount`: High-level telemetry signal.
- **Zoneless Bound**: Map mutations do NOT trigger Angular change detection. Only UI-bound signals emit.